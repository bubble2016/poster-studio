<!doctype html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>包站公告发布系统 Web</title>
  <link rel="icon" href="/favicon.ico?v=20260225v421" type="image/x-icon" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&family=Noto+Sans+SC:wght@400;500;700;900&display=swap"
    rel="stylesheet">
  {% if initial_theme %}
  <style>
    :root {
      --primary: {{ initial_theme.primary }};
      --primary-rgb: {{ initial_theme.primary_rgb }};
      --primary-strong: {{ initial_theme.primary_strong }};
      --primary-soft: {{ initial_theme.primary_soft }};
      --primary-surface: {{ initial_theme.primary_surface }};
    }
  </style>
  {% endif %}
  <script>
    (() => {
      try {
        const raw = localStorage.getItem("poster_guest_draft_v1");
        if (raw) {
          const parsed = JSON.parse(raw);
          const updatedAt = Number(parsed?.updated_at || 0);
          const notExpired = Number.isFinite(updatedAt) && updatedAt > 0 && (Date.now() - updatedAt <= 30 * 24 * 60 * 60 * 1000);
          const theme = String(parsed?.config?.theme_color || "").trim();
          if (parsed?.version === 1 && notExpired && /^#[0-9a-fA-F]{6}$/.test(theme)) {
            const hex = theme.toUpperCase();
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            const mixWithWhite = (ratio) => {
              const t = Math.max(0, Math.min(1, Number(ratio) || 0));
              const nr = Math.round(r + (255 - r) * t);
              const ng = Math.round(g + (255 - g) * t);
              const nb = Math.round(b + (255 - b) * t);
              return `#${[nr, ng, nb].map((x) => x.toString(16).padStart(2, "0")).join("").toUpperCase()}`;
            };
            const root = document.documentElement;
            root.style.setProperty("--primary", hex);
            root.style.setProperty("--primary-rgb", `${r}, ${g}, ${b}`);
            root.style.setProperty("--primary-strong", mixWithWhite(0.05));
            root.style.setProperty("--primary-soft", mixWithWhite(0.2));
            root.style.setProperty("--primary-surface", mixWithWhite(0.88));
          }
        }
      } catch (_) { }
      try {
        if (localStorage.getItem("poster_template_manager_collapsed_v1") === "1") {
          document.documentElement.setAttribute("data-tm-collapsed", "1");
        }
      } catch (_) { }
    })();
  </script>
  <link rel="stylesheet" href="/static/style.css?v=20260301v403" />
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>
</head>

<body class="{{ initial_bg_variant or '' }}">
  <div class="bg-orb orb-a"></div>
  <div class="bg-orb orb-b"></div>

  <main class="app">
    <header class="topbar">
      <div class="brand-shell">
        <div class="brand-mark-wrap" aria-hidden="true">
          <img class="brand-mark" src="/favicon.ico" alt="" />
        </div>
        <div class="brand-copy">
          <p class="brand-kicker">POSTER STUDIO</p>
          <h1>打包站公告发布工具</h1>
          <p class="brand-meta">快捷的公告发布系统，专为打包站打造</p>
        </div>
      </div>
      <div class="topbar-actions">
        <button id="openSettingsBtn" class="ghost-btn icon-btn" aria-label="设置" title="设置" type="button"
          aria-haspopup="menu" aria-expanded="false" aria-controls="settingsMenu">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path
              d="M4 7.25a1.25 1.25 0 0 1 1.25-1.25h13.5a1.25 1.25 0 1 1 0 2.5H5.25A1.25 1.25 0 0 1 4 7.25Zm0 4.75a1.25 1.25 0 0 1 1.25-1.25h13.5a1.25 1.25 0 1 1 0 2.5H5.25A1.25 1.25 0 0 1 4 12Zm0 4.75a1.25 1.25 0 0 1 1.25-1.25h13.5a1.25 1.25 0 1 1 0 2.5H5.25A1.25 1.25 0 0 1 4 16.75Z" />
          </svg>
        </button>
        <div id="settingsMenu" class="settings-menu" role="menu" aria-label="设置菜单" hidden>
          <p id="settingsMenuUser" class="settings-menu-user">当前身份：未登录</p>
          <button id="settingsMenuAuthBtn" class="settings-menu-item" type="button" role="menuitem">登录 / 注册</button>
          <button id="clearGuestDraftBtn" class="settings-menu-item" type="button" role="menuitem"
            hidden>清空访客草稿</button>
          <button id="settingsMenuPanelBtn" class="settings-menu-item" type="button" role="menuitem">打开设置</button>
        </div>
      </div>
    </header>

    <div class="workspace">
      <section class="card preview-card">
        <div class="section-head">
          <h2>实时预览</h2>
          <div class="preview-tools">
            <span id="statusText" aria-live="polite">准备就绪</span>
            <button id="togglePreviewFocusBtn" class="ghost-btn preview-focus-btn" type="button" aria-pressed="false"
              title="全屏预览（桌面双击可进入；按 ESC 或再次点击退出）">全屏预览</button>
          </div>
        </div>
        <div id="previewStage" class="preview-stage is-loading">
          <div id="previewPlaceholder" class="preview-placeholder">

            <div class="loading-runway-wrap">
              <div class="loading-runway">
                <div id="forkliftGroup" class="forklift-group">
                  <svg class="forklift-svg" viewBox="0 0 160 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <!-- Canopy -->
                    <rect x="30" y="11" width="34" height="7" rx="2" fill="var(--primary-strong)" />
                    <path d="M34 18 v18 M57 18 v17" stroke="var(--primary-strong)" stroke-width="2"
                      stroke-linecap="round" />

                    <!-- Driver -->
                    <rect x="38" y="24" width="13" height="15" rx="3" fill="var(--primary)" />
                    <circle cx="44" cy="18" r="6" fill="var(--primary)" />
                    <path d="M44 32 Q56 38 66 35" stroke="var(--primary)" stroke-width="3" stroke-linecap="round" />
                    <path d="M16 20 h35 l10 22 h25" stroke="var(--primary-soft)" stroke-width="3" stroke-linecap="round"
                      stroke-linejoin="round" />
                    <path d="M12 40 h65 v20 h-41 v6 h-24 v-6 h-8 l4 -15 z" fill="var(--primary)"
                      stroke="var(--primary)"
                      stroke-width="2" stroke-linejoin="round" />

                    <!-- Mast -->
                    <rect x="78" y="8" width="8" height="62" rx="1" fill="var(--primary-strong)" />

                    <!-- Bale Carriage (Backplate) -->
                    <rect x="86" y="20" width="8" height="50" rx="2" fill="var(--primary-strong)" />

                    <!-- Paper Bale -->
                    <path d="M 94 18 Q 112 16, 126 19 L 142 18 Q 145 35, 142 47 L 143 65 Q 119 68, 99 65 L 94 63 Z"
                      fill="#e2e4e6" stroke="#b0b5ba" stroke-width="1.5" stroke-linejoin="round" />

                    <!-- Paper Bale Textures -->
                    <path
                      d="M 96 24 Q 108 25 120 24 M 128 25 Q 136 23 142 25 M 98 32 L 116 30 M 124 32 L 140 32 M 98 42 L 120 44 M 126 43 L 140 45 M 96 52 L 110 50 M 118 51 Q 132 54 140 50 M 96 58 Q 116 60 138 60"
                      stroke="#ccc" stroke-width="1.5" stroke-linecap="round" />
                    <path
                      d="M 104 17 Q 105 38 105 65 M 116 18 Q 117 38 117 66 M 128 18 Q 129 38 129 66 M 138 18 Q 139 38 139 66"
                      stroke="#a3a8ad" stroke-width="1.5" style="stroke-dasharray: 2 2;" />

                    <!-- Near Clamp Arm (Horizontal Narrow Clamp) -->
                    <rect x="86" y="35" width="6" height="20" rx="2" fill="var(--primary-strong)" />
                    <path d="M 92 35 H 132 V 55 H 92 Z M 100 41 H 122 V 49 H 100 Z" fill="var(--primary)"
                      fill-rule="evenodd" stroke="var(--primary-strong)" stroke-width="1.5" stroke-linejoin="round" />

                    <!-- Wheels -->
                    <circle cx="24" cy="69" r="8" fill="#333" />
                    <circle cx="24" cy="69" r="3.5" fill="#666" />
                    <circle cx="66" cy="65" r="12" fill="#333" />
                    <circle cx="66" cy="65" r="5.5" fill="#666" />
                  </svg>
                </div>
              </div>
              <div class="preview-loading-text" id="loadingProgressText">正在打包生成 0%</div>
            </div>
          </div>
          <img id="previewImage" alt="海报预览" />
          <div id="previewFocusToast" class="preview-focus-toast" aria-live="polite" hidden></div>
          <div id="fullscreenExitHint" class="fullscreen-exit-hint" hidden aria-hidden="true">
            <span class="fullscreen-exit-hint-inner">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3" />
              </svg>
              点击按钮 或 按 <kbd>ESC</kbd> 退出全屏
            </span>
          </div>
        </div>
      </section>

      <section class="editor-col" id="editorDrawer">
        <button id="editorDrawerToggleBtn" class="drawer-toggle" type="button" aria-expanded="false"
          hidden>展开编辑区</button>
        <section class="card form-card">
          <div class="field-grid">
            <label>标题<input id="titleInput" /></label>
            <label class="date-field">日期
              <span class="date-input-wrap">
                <input id="dateInput" type="text" inputmode="numeric" placeholder="如：2026-02-24" autocomplete="off"
                  spellcheck="false" />
                <input id="dateInputPicker" type="date" aria-hidden="true" tabindex="-1" />
                <button id="dateInputIconBtn" class="date-input-icon" type="button" aria-label="打开日期选择">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path
                      d="M7 2a1 1 0 0 1 1 1v1h8V3a1 1 0 1 1 2 0v1h1.25A2.75 2.75 0 0 1 22 6.75v12.5A2.75 2.75 0 0 1 19.25 22H4.75A2.75 2.75 0 0 1 2 19.25V6.75A2.75 2.75 0 0 1 4.75 4H6V3a1 1 0 0 1 1-1Zm12.25 8H4v9.25c0 .41.34.75.75.75h14.5c.41 0 .75-.34.75-.75V10ZM4.75 6a.75.75 0 0 0-.75.75V8h16V6.75a.75.75 0 0 0-.75-.75h-1.5v1a1 1 0 1 1-2 0V6h-8v1a1 1 0 1 1-2 0V6h-1ZM7 12.75a1 1 0 1 1 0 2h1.5a1 1 0 1 1 0-2H7Zm4.25 0a1 1 0 1 1 0 2h1.5a1 1 0 1 1 0-2h-1.5Zm4.25 0a1 1 0 1 1 0 2H17a1 1 0 1 1 0-2h-1.5Z" />
                  </svg>
                </button>
              </span>
            </label>
          </div>
          <div class="row">
            <button class="mini-btn" id="todayBtn">今天</button>
            <button class="mini-btn" id="tomorrowBtn">+1 天</button>
            <button class="mini-btn" id="formatBtn">自动格式化</button>
            <button class="mini-btn" id="batchBtn">批量调价</button>
          </div>
          <textarea id="contentInput" rows="10" hidden placeholder="请输入正文内容"></textarea>
          <div id="priceEditorPanel">
            <div class="section-head">
              <h2>价格表内容</h2>
            </div>
            <p class="price-editor-tip">直接在下方编辑，生成时会自动转为正文格式。</p>
            <div class="price-editor-table-wrap">
              <table class="price-editor-table">
                <colgroup>
                  <col class="col-drag" />
                  <col class="col-name" />
                  <col class="col-mode" />
                  <col class="col-value" />
                  <col class="col-unit" />
                  <col class="col-action" />
                </colgroup>
                <thead>
                  <tr>
                    <th></th>
                    <th>品类</th>
                    <th>类型</th>
                    <th>值</th>
                    <th>单位</th>
                    <th>操作</th>
                  </tr>
                </thead>
                <tbody id="priceTableBody"></tbody>
              </table>
            </div>
            <div class="price-editor-add-wrap">
              <button class="mini-btn" id="addPriceRowBtn" type="button">新增一行</button>
            </div>
            <label>附加说明（非价格内容）
              <textarea id="priceEditorExtra" rows="4" placeholder="例如：温馨提示、假期通知等"></textarea>
            </label>
          </div>
          <div class="stats" id="statsText">0 字 · 0 行</div>
        </section>

        <section class="card template-manager-card" id="templateManagerCard">
          <div class="section-head template-manager-head">
            <h2>模板管理</h2>
            <div class="template-toggle-wrap">
              <button id="templateManagerToggleBtn" class="ghost-btn template-manager-toggle" type="button"
                aria-expanded="false" aria-controls="templateManagerBody">展开</button>
              <aside id="templateManagerTip" class="template-manager-tip" hidden>
                <p>这里可以收起模板管理模块，聚焦主编辑区</p>
                <button id="templateManagerTipAcknowledgeBtn" class="template-manager-tip-btn"
                  type="button">知道了</button>
              </aside>
            </div>
          </div>
          <div class="field-grid template-manager-body" id="templateManagerBody">
            <label>模板
              <select id="templateSelect"></select>
            </label>
            <label>导出格式
              <select id="exportFormat">
                <option>PNG</option>
                <option>JPEG</option>
                <option>PDF</option>
              </select>
            </label>
          </div>
          <div class="row template-manager-body">
            <button class="mini-btn" id="saveTemplateBtn">保存模板</button>
            <button class="mini-btn danger" id="deleteTemplateBtn">删除模板</button>
          </div>
        </section>

        <footer class="action-bar">
          <button id="generateBtn" class="primary pill-btn">生成</button>
          <p id="actionBarNote" class="action-bar-note">
            <span>© 2026 开发者：李学涛</span>
            <span class="action-bar-sep">|</span>
            <a class="action-bar-link" href="/terms" target="_blank" rel="noopener noreferrer">用户协议</a>
            <span class="action-bar-sep">|</span>
            <a class="action-bar-link" href="/privacy" target="_blank" rel="noopener noreferrer">隐私政策</a>
            <span class="action-bar-sep action-bar-sep-record">|</span>
            <a class="action-bar-link action-bar-record" href="https://beian.miit.gov.cn/" target="_blank" rel="noopener noreferrer">豫ICP备2026007593号</a>
          </p>
        </footer>
      </section>
    </div>
  </main>

  <div id="settingsModal" class="modal hidden" aria-hidden="true">
    <div id="settingsMask" class="modal-mask"></div>
    <section class="modal-panel" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <header class="modal-head">
        <h2 id="settingsTitle">全局设置</h2>
      </header>
      <div class="modal-body">
        <div class="settings-tabs" role="tablist" aria-label="设置分组">
          <button class="settings-tab is-active" type="button" role="tab" aria-selected="true"
            aria-controls="settingsPaneBase" data-settings-tab="base">基础信息</button>
          <button class="settings-tab" type="button" role="tab" aria-selected="false" aria-controls="settingsPaneStyle"
            data-settings-tab="style">视觉风格</button>
          <button class="settings-tab" type="button" role="tab" aria-selected="false" aria-controls="settingsPaneMedia"
            data-settings-tab="media">图片素材</button>
          <button class="settings-tab" type="button" role="tab" aria-selected="false" aria-controls="settingsPaneParam"
            data-settings-tab="param">参数设置</button>
        </div>

        <section id="settingsPaneBase" class="card modal-card settings-pane is-active" role="tabpanel"
          data-settings-pane="base">
          <label>店铺名称<input id="shopName" /></label>
          <label>联系电话<input id="phone" /></label>
          <label>地址<input id="address" /></label>
          <label>标语<input id="slogan" /></label>
        </section>

        <section id="settingsPaneStyle" class="card modal-card settings-pane" role="tabpanel" data-settings-pane="style"
          hidden>
          <div class="field-grid">
            <label class="theme-color-field">主题色
              <div class="theme-color-row">
                <input id="themeColor" type="color" />
                <span id="themeColorHex" class="theme-color-hex">#B22222</span>
              </div>
              <div id="themePalette" class="theme-palette" aria-label="推荐主题色">
                <button type="button" class="theme-swatch" data-color="#D32F2F" title="#D32F2F"
                  aria-label="推荐色 #D32F2F"></button>
                <button type="button" class="theme-swatch" data-color="#E11D48" title="#E11D48"
                  aria-label="推荐色 #E11D48"></button>
                <button type="button" class="theme-swatch" data-color="#EA580C" title="#EA580C"
                  aria-label="推荐色 #EA580C"></button>
                <button type="button" class="theme-swatch" data-color="#F59E0B" title="#F59E0B"
                  aria-label="推荐色 #F59E0B"></button>
                <button type="button" class="theme-swatch" data-color="#65A30D" title="#65A30D"
                  aria-label="推荐色 #65A30D"></button>
                <button type="button" class="theme-swatch" data-color="#16A34A" title="#16A34A"
                  aria-label="推荐色 #16A34A"></button>
                <button type="button" class="theme-swatch" data-color="#0D9488" title="#0D9488"
                  aria-label="推荐色 #0D9488"></button>
                <button type="button" class="theme-swatch" data-color="#2563EB" title="#2563EB"
                  aria-label="推荐色 #2563EB"></button>
                <button type="button" class="theme-swatch" data-color="#1D4ED8" title="#1D4ED8"
                  aria-label="推荐色 #1D4ED8"></button>
                <button type="button" class="theme-swatch" data-color="#0891B2" title="#0891B2"
                  aria-label="推荐色 #0891B2"></button>
                <button type="button" class="theme-swatch" data-color="#7C3AED" title="#7C3AED"
                  aria-label="推荐色 #7C3AED"></button>
                <button type="button" class="theme-swatch" data-color="#9333EA" title="#9333EA"
                  aria-label="推荐色 #9333EA"></button>
                <button type="button" class="theme-swatch" data-color="#DB2777" title="#DB2777"
                  aria-label="推荐色 #DB2777"></button>
                <button type="button" class="theme-swatch" data-color="#475569" title="#475569"
                  aria-label="推荐色 #475569"></button>
              </div>
            </label>
            <label>样式
              <select id="cardStyle">
                <option value="single">单张</option>
                <option value="stack">堆叠</option>
                <option value="block">3D立体</option>
                <option value="flip">翻页</option>
                <option value="ticket">票据</option>
                <option value="double">双层</option>
                <option value="aurora">极光玻璃</option>
                <option value="paper_relief">纸感浮雕</option>
              </select>
              <div id="cardStyleGallery" class="card-style-gallery" role="listbox" aria-label="卡片样式预览"></div>
              <p class="settings-inline-hint">点击小图即可切换样式</p>
            </label>
            <label>
              <span class="range-label"><span>卡片透明度</span><span id="cardOpacityValue"
                  class="range-value">100%</span></span>
              <input id="cardOpacity" type="range" min="0.1" max="1" step="0.05" />
            </label>
            <label>价格色
              <select id="priceColorMode">
                <option value="semantic">保留涨跌红绿</option>
                <option value="theme">跟随主题色</option>
              </select>
            </label>
          </div>
        </section>

        <section id="settingsPaneMedia" class="card modal-card settings-pane" role="tabpanel" data-settings-pane="media"
          hidden>
          <p>访客模式默认不显示 Logo。你可以在这里直接上传自己的包站 Logo、印章和二维码。</p>
          <div class="field-group">
            <label>背景预设</label>
            <div id="presetGrid" class="preset-grid">
              <div class="preset-item is-active" data-path="">
                <div class="preset-thumb-none">无</div>
                <span class="preset-name">不使用</span>
              </div>
            </div>
          </div>
          <div class="field-grid media-grid">
            <label class="upload-field upload-field-bg">背景图
              <input id="bgUpload" type="file" accept="image/*" />
              <p class="upload-hint">JPG / PNG / WebP · 最大 15MB</p>
              <div class="upload-thumb" id="bgThumbWrap" data-kind="背景图" hidden>
                <img id="bgThumb" alt="背景图缩略图" loading="lazy" />
                <button id="bgThumbRandomBtn" class="upload-thumb-random" type="button" aria-label="随机选择背景图">随机</button>
                <button id="bgThumbRemoveBtn" class="upload-thumb-remove" type="button" aria-label="删除背景图">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M3 6h18" />
                    <path d="M9 6V4h6v2" />
                    <path d="M19 6l-1 14H6L5 6" />
                    <path d="M10 11v6" />
                    <path d="M14 11v6" />
                  </svg>
                </button>
              </div>
            </label>
            <label class="upload-field upload-field-logo">Logo
              <input id="logoUpload" type="file" accept="image/*" />
              <p class="upload-hint">JPG / PNG / WebP · 最大 15MB · 支持自动裁剪</p>
              <div class="upload-thumb" id="logoThumbWrap" data-kind="Logo" hidden>
                <img id="logoThumb" alt="Logo 缩略图" loading="lazy" />
                <button id="logoThumbRandomBtn" class="upload-thumb-random" type="button"
                  aria-label="随机选择 Logo">随机</button>
                <button id="logoThumbRemoveBtn" class="upload-thumb-remove" type="button" aria-label="删除 Logo">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M3 6h18" />
                    <path d="M9 6V4h6v2" />
                    <path d="M19 6l-1 14H6L5 6" />
                    <path d="M10 11v6" />
                    <path d="M14 11v6" />
                  </svg>
                </button>
              </div>
            </label>
            <label class="upload-field upload-field-stamp">印章
              <input id="stampUpload" type="file" accept="image/*" />
              <p class="upload-hint">建议使用透明背景 PNG · 最大 15MB</p>
              <div class="upload-thumb" id="stampThumbWrap" data-kind="印章" hidden>
                <img id="stampThumb" alt="印章缩略图" loading="lazy" />
                <button id="stampThumbRemoveBtn" class="upload-thumb-remove" type="button" aria-label="删除印章">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M3 6h18" />
                    <path d="M9 6V4h6v2" />
                    <path d="M19 6l-1 14H6L5 6" />
                    <path d="M10 11v6" />
                    <path d="M14 11v6" />
                  </svg>
                </button>
              </div>
            </label>
            <label class="upload-field upload-field-qr">二维码
              <input id="qrUpload" type="file" accept="image/*" />
              <p class="upload-hint">JPG / PNG / WebP · 最大 15MB</p>
              <div class="upload-thumb" id="qrThumbWrap" data-kind="二维码" hidden>
                <img id="qrThumb" alt="二维码缩略图" loading="lazy" />
                <button id="qrThumbRemoveBtn" class="upload-thumb-remove" type="button" aria-label="删除二维码">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M3 6h18" />
                    <path d="M9 6V4h6v2" />
                    <path d="M19 6l-1 14H6L5 6" />
                    <path d="M10 11v6" />
                    <path d="M14 11v6" />
                  </svg>
                </button>
              </div>
            </label>
          </div>
        </section>

        <section id="settingsPaneParam" class="card modal-card settings-pane" role="tabpanel" data-settings-pane="param"
          hidden>
          <p class="settings-subhead">背景参数</p>
          <label>
            <span class="range-label"><span>背景模糊</span><span id="bgBlurValue" class="range-value">0</span></span>
            <input id="bgBlur" type="range" min="0" max="30" step="1" />
          </label>
          <label>
            <span class="range-label"><span>背景亮度</span><span id="bgBrightnessValue"
                class="range-value">1.00x</span></span>
            <input id="bgBrightness" type="range" min="0.5" max="1.5" step="0.05" />
          </label>
          <p class="settings-subhead">印章参数</p>
          <label>
            <span class="range-label"><span>印章透明度</span><span id="stampOpacityValue"
                class="range-value">85%</span></span>
            <input id="stampOpacity" type="range" min="0.1" max="1" step="0.05" />
          </label>
          <p class="settings-subhead">水印参数</p>
          <label class="switch-line">
            <input id="watermarkEnabled" type="checkbox" /> 启用水印
          </label>
          <label>水印文字<input id="watermarkText" /></label>
          <label>
            <span class="range-label"><span>水印透明度</span><span id="watermarkOpacityValue"
                class="range-value">15%</span></span>
            <input id="watermarkOpacity" type="range" min="0.05" max="0.5" step="0.05" />
          </label>
          <label>
            <span class="range-label"><span>水印密度</span><span id="watermarkDensityValue"
                class="range-value">1.0x</span></span>
            <input id="watermarkDensity" type="range" min="0.5" max="2" step="0.1" />
          </label>
        </section>
      </div>
      <footer class="modal-actions">
        <button id="closeSettingsBtn2">取消</button>
        <button id="saveConfigBtn" class="primary">保存设置</button>
      </footer>
    </section>
  </div>

  <div id="loginModal" class="modal hidden" aria-hidden="true">
    <div id="loginMask" class="modal-mask"></div>
    <section class="modal-panel modal-panel-sm" role="dialog" aria-modal="true" aria-labelledby="loginTitle">
      <header class="modal-head">
        <h2 id="loginTitle">用户登录</h2>
      </header>
      <div class="modal-body">
        <label>用户ID
          <input id="loginUserIdInput" placeholder="仅支持字母/数字/_/-" autocomplete="username" />
        </label>
        <label>密码
          <div class="password-row">
            <input id="loginPasswordInput" type="password" placeholder="至少 4 位" autocomplete="current-password" />
            <button id="toggleLoginPwdBtn" class="ghost-btn" type="button">显示</button>
          </div>
        </label>
        <div id="loginErrorText" class="form-error" aria-live="polite"></div>
      </div>
      <footer class="modal-actions">
        <button id="cancelLoginBtn" type="button">取消</button>
        <button id="confirmLoginBtn" class="primary" type="button">登录/创建</button>
      </footer>
    </section>
  </div>

  <div id="logoCropModal" class="modal hidden" aria-hidden="true">
    <div id="logoCropMask" class="modal-mask"></div>
    <section class="modal-panel modal-panel-sm" role="dialog" aria-modal="true" aria-labelledby="logoCropTitle">
      <header class="modal-head">
        <h2 id="logoCropTitle">裁剪 Logo</h2>
      </header>
      <div class="modal-body">
        <p class="crop-tip">用手指直接拖动预览区域即可移动裁剪位置，建议将主体放在中间。</p>
        <canvas id="logoCropCanvas" width="320" height="320"></canvas>
        <label>缩放<input id="logoCropScale" type="range" min="1" max="3" step="0.01" value="1" /></label>
      </div>
      <footer class="modal-actions">
        <button id="cancelLogoCropBtn" type="button">取消</button>
        <button id="confirmLogoCropBtn" class="primary" type="button">确认裁剪</button>
      </footer>
    </section>
  </div>

  <div id="priceRowDrawerModal" class="modal hidden" aria-hidden="true">
    <div id="priceDrawerMask" class="modal-mask"></div>
    <section class="modal-panel modal-panel-sm price-drawer-panel" role="dialog" aria-modal="true"
      aria-labelledby="priceDrawerTitle">
      <header class="modal-head">
        <h2 id="priceDrawerTitle">编辑纸种</h2>
        <button id="closePriceDrawerBtn" class="ghost-btn" type="button">关闭</button>
      </header>
      <div class="modal-body">
        <div class="drawer-row drawer-row-2">
          <label class="drawer-inline-field"><span class="drawer-field-label">纸种</span><input
              id="priceDrawerName" /></label>
          <label class="drawer-inline-field"><span class="drawer-field-label">单位</span><input id="priceDrawerUnit"
              placeholder="元/吨" /></label>
        </div>
        <div class="drawer-row drawer-row-2 drawer-type-value-row">
          <label class="drawer-inline-field"><span class="drawer-field-label">类型</span>
            <select id="priceDrawerMode">
              <option value="number">单价</option>
              <option value="range">区间</option>
              <option value="text">文字</option>
            </select>
          </label>
          <div class="drawer-value-slot">
            <div id="priceDrawerValueNumberWrap">
              <label class="drawer-inline-field"><span class="drawer-field-label">值</span><input id="priceDrawerValue"
                  inputmode="decimal" placeholder="例如：1350" /></label>
            </div>
            <div id="priceDrawerValueRangeWrap" class="drawer-row drawer-range-wrap" hidden>
              <input class="drawer-range-input" id="priceDrawerMin" inputmode="decimal" />
              <span class="drawer-range-sep" aria-hidden="true">-</span>
              <input class="drawer-range-input" id="priceDrawerMax" inputmode="decimal" />
            </div>
            <div id="priceDrawerValueTextWrap" hidden>
              <label class="drawer-inline-field"><span class="drawer-field-label">说明</span><input id="priceDrawerText"
                  placeholder="例如：上调50" /></label>
            </div>
          </div>
        </div>
      </div>
      <footer class="modal-actions modal-actions-2">
        <button id="deletePriceDrawerBtn" class="danger" type="button">删除</button>
        <button id="savePriceDrawerBtn" class="primary" type="button">保存</button>
      </footer>
    </section>
  </div>

  <div id="dialogModal" class="modal hidden" aria-hidden="true">
    <div id="dialogMask" class="modal-mask"></div>
    <section class="modal-panel modal-panel-sm dialog-panel" role="dialog" aria-modal="true"
      aria-labelledby="dialogTitle">
      <header class="modal-head">
        <h2 id="dialogTitle">提示</h2>
        <button id="closeDialogBtn" class="ghost-btn" type="button">关闭</button>
      </header>
      <div class="modal-body">
        <div id="dialogMessage" class="dialog-message"></div>
        <label id="dialogInputWrap" hidden>请输入
          <input id="dialogInput" />
        </label>
      </div>
      <footer class="modal-actions">
        <button id="dialogCancelBtn" type="button">取消</button>
        <button id="dialogConfirmBtn" class="primary" type="button">确定</button>
      </footer>
    </section>
  </div>

  <script src="/static/app.js?v=20260301v403"></script>
</body>

</html>

